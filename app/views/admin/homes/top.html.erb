<div class = "container">
  <div class = "row">
    <div class = "col-md-8 mx-auto">
    <h1>注文履歴一覧</h1>
    <div class = "table-responsive-md">
      <table class = "table text-nowrap table-bordered">
        <thead class = "table-dark">
          <tr>
            <th>購入日時</th>
            <th>購入者</th>
            <th>注文個数</th>
            <th>注文ステータス</th>
          </tr>
        </thead>
        <tbody>
        <% @orders. each do |order| %>
        <tr>
          <td>
          <%= link_to admin_order_path(order) do %>
            <%= order.created_at.strftime('%Y/%m/%d %H:%M:%S') %>
          <% end %>
          </td>
          <td><%= order.customer.full_name %></td>
          <td>
            <% @total_quantity = 0 %>
            <!--orderに結びつくorder_detailのquantityを取り出して合計数を表示する-->
            <% order.order_details.each do |order_detail| %>
            <% @total_quantity += order_detail.quantity %>
            <% end %>
            <%= @total_quantity %>
          </td>
          <td><%= order.status_i18n %></td>
        </tr>
        <% end %>
        </tbody>
      </table>
    </div>
    <%= paginate @orders, theme: 'bootstrap-5' %>
    </div>
  </div>
</div>

